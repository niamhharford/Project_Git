---
title: "Selecting Variables"
author: "Niamh Harford 20251644"
date: "3/4/2021"
output: html_document
---

The explanatory variables I want:

(1) Age - transform from continues features to Categorical features to understand the relationship among the features

(2) Gender

(3) Race

(4) Smoking - Smokers defined as individuals having smoked ≥ 100 cigarettes during their lifetime (SMQ020) and currently smoke some days or every day (SMQ040) 

(5) Kidney disease - Chronic kidney disease (CKD) defined as “yes” response to the question “Have you ever told by a health care provider you have weak or failing kidneys?”, Do not include kidney stones, bladder infections, or incontinence (KIQ022) and In the past 12 months, {Have you/Has SP} had difficult controlling {you/his/her} bladder, including leaking small amounts of urine when {you/s/he} cough {s} or sneeze {s}? {Do not include bladder control difficulties during pregnancy or recovery from childbirth.} (KIQ025)

(6) Diabetes - Participants admit to have diabetes if the answer presents “Yes or “Borderline” to the question “Doctor told that you have diabetes?” (DIQ010) and {Is SP/Are you} now taking insulin (DIQ050)

(7) BMI (Body Mass Index) - transform from continues features to Categorical features to understand the relationship among the features. Body Mass Index (kg/m**2) (BMXBMI)

The response variable:
(1) Blood pressure is utilized to generate the dependent feature.
Hypertension category designated as systolic blood pressure of ≥ 130 mmHg, previously define as ≥ 140 mmHg by the American Heart Association. {Have you/Has SP} ever been told by a doctor or other health professional that {you/s/he} had hypertension, also called high blood pressure? - (BPQ020)

```{r}
suppressMessages(library(nhanesA))
suppressMessages(library(tidyverse))


# nhanesTableVars('DEMO', 'DEMO_I')
# nhanesTableVars('Q', 'SMQ_J') 
# nhanesTableVars('Q', 'DIQ_J')  
# nhanesTableVars('Q', 'KIQ_U_J') 
# nhanesTableVars('Q','BPQ_I')

```


DEMO_I

(1) RIAGENDR - Gender of participant

(2) RIDAGEYR - Age in years of the participant at the time of screening. Individuals 80 and over are topcoded at 80 years of age.


(3) RIDRETH1 - Recode of reported race and ethnicity information.

```{r}
#2015/2016 data
smq_i <- nhanes('SMQ_I') 
demo_i <- nhanes('DEMO_I')
diq_i <- nhanes('DIQ_I')
kiq_u_i <- nhanes('KIQ_U_I')
bmx_i <- nhanes('BMX_I')
bpq_i <- nhanes('BPQ_I')
```

```{r}
#Translate
demo_i <- nhanesTranslate('DEMO_I', c('RIAGENDR', 'RIDRETH1'), data=demo_i)
bmx_i <- nhanesTranslate('BMX_I', 'BMXBMI', data=bmx_i) #no columns translated
smq_i <- nhanesTranslate('SMQ_I', c('SMQ020','SMQ040'), data=smq_i)
diq_i <- nhanesTranslate('DIQ_I', c('DIQ010', 'DIQ050'), data=diq_i)
kiq_u_i <- nhanesTranslate('KIQ_U_I', c('KIQ022', 'KIQ025'), data=kiq_u_i)
bpq_i <- nhanesTranslate('BPQ_I', 'BPQ020', data=bpq_i)
```

```{r}
#merging the data
comb1 <- merge(demo_i, smq_i)
comb2 <- merge(comb1, diq_i)
comb3 <- merge(comb2, kiq_u_i)
comb4 <- merge(comb3, bmx_i)
comb5 <- merge(comb4, bpq_i)
select_cols <- c('BPQ020','RIAGENDR', 'RIDAGEYR', 'RIDRETH1', 'SMQ020','SMQ040', 'DIQ010', 'DIQ050', 'KIQ022', 'KIQ025', 'BMXBMI')
combined_data <- comb5 %>% select(all_of(select_cols))
```

```{r}
#Another way to join data
data_combined <- Reduce(merge, list(demo_i, smq_i, diq_i, kiq_u_i, bmx_i, bpq_i))
data_combined <- data_combined %>% select(all_of(select_cols))
head(data_combined)
```



